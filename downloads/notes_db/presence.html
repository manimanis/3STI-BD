<!DOCTYPE html>
<html lang="ar">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <main id="app" class="container my-5">
    <div v-if="mode == 'menu'">
      <h1>القائمة الرئيسية</h1>
      <ul>
        <li><a href="#" v-on:click.prevent="setMode('edit')">مراقبة الكراسات</a></li>
        <li><a href="#" v-on:click.prevent="setMode('download')">حفظ المعطيات</a></li>
        <li><a href="#" v-on:click.prevent="setMode('upload')">توريد المعطيات</a></li>
      </ul>
    </div>
    <div v-if="mode == 'download'">
      <div class="my-2"><a href="#" v-on:click.prevent="setMode('menu')">الرجوع للقائمة الرئيسية</a></div>
      <h1>حفظ المعطيات</h1>
      <div class="my-2"><a href="#" class="btn btn-primary" v-on:click.prevent="downloadData()">حفظ المعطيات</a></div>
    </div>
    <div v-if="mode == 'upload'">
      <div class="my-2"><a href="#" v-on:click.prevent="setMode('menu')">الرجوع للقائمة الرئيسية</a></div>
      <h1>توريد المعطيات</h1>
      <p><textarea v-model="uploadDataText" cols="30" rows="10" class="form-control"></textarea></p>
      <div class="my-2"><a href="#" class="btn btn-primary" v-on:click.prevent="uploadData()">توريد المعطيات</a></div>
    </div>
    <div v-if="mode == 'edit'">
      <div class="my-2"><a href="#" v-on:click.prevent="setMode('menu')">الرجوع للقائمة الرئيسية</a></div>
      <h1>مرلقبة الكراسات</h1>
      <div v-if="selectedDate == -1">
        <div>
          <p>اختيار التاريخ لتسجيل الملاحظات.</p>
        </div>
        <div class="calendar">
          <div v-for="mois in mois" class="monthCalendar">
            <div class="monthName">{{mois['monthName']}} {{mois['year']}}</div>
            <div class="weekDays">
              <span v-for="day in days" class="weekDay">{{day}}</span>
            </div>
            <div class="monthDays">
              <span v-for="day in mois['emptyDays']" class="weekDay">&nbsp;</span>
              <span v-for="jour, idxJour in mois['allDays']" class="monthDay"
                v-bind:class="{'highlightDate': getHighlightedDateIndex(jour) != -1, 'todayDate': jour.getTime() == todayDate.getTime()}"
                v-on:click="selectDate(jour)">{{jour.getDate()}}</span>
            </div>
          </div>
        </div>
      </div>
      <div v-if="selectedDate != -1">
        <table class="dataframe">
          <thead>
            <tr style="text-align: right;">
              <th class="undefined"></th>
              <th class="undefined">الإسم واللقب</th>
              <th v-for="date, idxDate in dates" v-if="selectedDate == idxDate" v-bind:class="getColumnClass(date)">
                {{date.toLocaleDateString("ar-TN", {weekday: "long", year: "numeric", month: "long", day: "numeric"})}}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="name, idxName in eleves">
              <th>{{idxName+1}}</th>
              <td>{{name}}</td>
              <td v-for="date, idxDate in dates" v-if="selectedDate == idxDate" v-bind:class="getColumnClass(date)"
                v-on:click="beginChanging(idxName)">
                <span v-if="selectedField.idxName != idxName">{{tempData[idxName].length >
                  0 ? tempData[idxName] : "ملاحظات"}}</span>
                <span v-else><input type="text" v-bind:id="'data'+idxName" class="form-control"
                    v-model="tempData[idxName]" v-on:keyup.enter="endChanging()"></span>
              </td>
            </tr>
          </tbody>
        </table>
        <div>
          <button type="button" class="my-2 btn btn-success" v-on:click="saveChanges()">حفظ التغييرات</button>
          <button type="button" class="my-2 btn btn-danger" v-on:click="cancelChanges()">التراجع عن التغييرات</button>
        </div>
      </div>
    </div>
  </main>
  <script src="../../assets/js/vue.min.js"></script>
  <script src="vueapp.js"></script>
</body>

</html>