<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Base de données</title>
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/default.min.css">
  <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>
  <aside>
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Web</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#aside_navbar"
          aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span> Menu
        </button>
        <div class="collapse navbar-collapse" id="aside_navbar"></div>
      </div>
    </nav>
  </aside>

  <main class="my-4 container">
    <h1>Base de données</h1>
    <article>
      <h2>TP n°2</h2>
      <section>
        <h3>Partie Pratique</h3>
        <ol>
          <li>Créer une nouvelle base de données appelée <code>location_vehicules</code>. Puis, l'utiliser.
          </li>
          <li>Le gérant de l'agence de location de voitures a besoin des informations suivantes :
            <table class="table table-sm table-bordered table-striped border-dark dict-table mb-2">
              <thead>
                <tr>
                  <th>Colonne</th>
                  <th>Description</th>
                  <th>Type de données</th>
                  <th>Taille</th>
                  <th>Oblig.</th>
                  <th>Val. par déf.</th>
                  <th>Val. auto.</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>matricule</td>
                  <td>Matricule de la voiture</td>
                  <td>Texte</td>
                  <td>10</td>
                  <td>✔</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>vehicule</td>
                  <td>Marque de la voiture</td>
                  <td>Texte</td>
                  <td>32</td>
                  <td>✔</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>prix_unit</td>
                  <td>Prix de location pour une journée</td>
                  <td>Numérique réel</td>
                  <td>&nbsp;</td>
                  <td>✔</td>
                  <td>0.0</td>
                  <td>&ge; 0.0</td>
                </tr>
                <tr>
                  <td>libre</td>
                  <td>Indique si le véhicule est disponible pour la locations</td>
                  <td>Texte</td>
                  <td>1</td>
                  <td>✔</td>
                  <td>"O"</td>
                  <td>"O" ou "F"</td>
                </tr>
                <tr>
                  <td>cin</td>
                  <td>Numéro de la carte d'identité du client</td>
                  <td>Texte</td>
                  <td>10</td>
                  <td>✔</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>client</td>
                  <td>Nom du client</td>
                  <td>Texte</td>
                  <td>32</td>
                  <td>✔</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>genre</td>
                  <td>Genre du client (Homme / Femme)</td>
                  <td>Texte</td>
                  <td>1</td>
                  <td>✔</td>
                  <td>"H"</td>
                  <td>"H" ou "F"</td>
                </tr>
                <tr>
                  <td>tel</td>
                  <td>Téléphone du client</td>
                  <td>Texte</td>
                  <td>16</td>
                  <td>✔</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>num_location</td>
                  <td>Numéro de location</td>
                  <td>Entier</td>
                  <td></td>
                  <td>✔</td>
                  <td>Auto incrémenté</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>date_location</td>
                  <td>Date de location du véhicule</td>
                  <td>Date</td>
                  <td>&nbsp;</td>
                  <td>✔</td>
                  <td>Date du jour</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>date_retour</td>
                  <td>Date de retour du véhicule</td>
                  <td>Date</td>
                  <td>&nbsp;</td>
                  <td>✔</td>
                  <td>&nbsp;</td>
                  <td>date_retour > date_location</td>
                </tr>
                <tr>
                  <td>montant_location</td>
                  <td>Prix total de location du véhicule</td>
                  <td>Numérique réel</td>
                  <td>&nbsp;</td>
                  <td>✔</td>
                  <td>0.0</td>
                  <td>&ge; 0.0</td>
                </tr>
              </tbody>
            </table>
            <p><strong>On demande de regrouper ces colonnes dans plusieurs entités distinctes.</strong></p>
            <div class="d-none d-print-block">
              <h4 class="p-break">Solution</h4>
              <p>On peut dégager trois entités, correspodants aux objets du monde réel, à partir du tableau précédent :
              </p>
              <ul>
                <li>Entité <strong>vehicules</strong> qui rassemble les propriétés d'un véhcicule.</li>
                <li>Entité <strong>clients</strong> qui ressemble les propriétés d'un client.</li>
                <li>Entité <strong>locations</strong> qui rassemble les propriétés d'une location effectué par un
                  certain client à une date bien déterminée.</li>
              </ul>
              <p>Chacune des entités correspond à une table :</p>
              <p class="ps-4">vehicules(<u>matricule</u>, vehicule, prix_unit, libre)</p>
              <p class="ps-4">clients(<u>cin</u>, client, genre, tel)</p>
              <p class="ps-4">location(<u>num_location</u>, <b>cin#</b>, <b>matricule#</b>, date_location, date_retour,
                montant_location)</p>
              <p>Les champs <u>soulignés</u> sont les clés primaires qui permettent d'identifier les n-uplets d'une
                façon unique.</p>
              <p>Les champs <b>gras suivis par #</b> sont les clés étrangères qui permettent de relier la table
                <code>locations</code> aux autres tables, ainsi :
              </p>
              <ul>
                <li>Un client pourra effectuer un ou plusieurs locations.</li>
                <li>Un véhcicule pourra être loué une ou plusieurs fois.</li>
              </ul>
            </div>
          </li>
          <li>Créer la table <code>vehicules</code>.
            <p>Les enregistrement de la table sont identifiés par la colonne <code>matricule</code>.</p>
          </li>
          <li>Créer la table <code>clients</code>.
            <p>La table <code>clients</code> est identifiée par la colonne <code>cin</code>.</p>
          </li>
          <li>Créer la table <code>locations</code>.
            <p>La table est identifiée par le champ <code>num_location</code>.</p>
          </li>
          <li>Remplir la table <code>clients</code> par les données suivantes :
            <pre style="font-size: 0.8em;"><code class="nohighlight">+----------+--------+-------+----------+
| cin      | client | genre | tel      |
+----------+--------+-------+----------+
| 02500463 | Hajer  | F     | 36079515 |
| 03972583 | Amir   | M     | 36704253 |
| 04202363 | Aziz   | M     | 70116709 |
+----------+--------+-------+----------+</code></pre>
            <div class="d-none d-print-block">
              <pre><code class="sql">INSERT INTO clients (cin, client, genre, tel)
VALUES ('03972583', 'Amir', 'M', '36704253');</code></pre>
            </div>
          </li>
          <li>Remplir la table <code>vehicules</code> par les données suivantes :
            <pre style="font-size: 0.8em;"><code class="nohighlight">+-----------+------------------+-----------+-------+
| matricule | vehicule         | prix_unit | libre |
+-----------+------------------+-----------+-------+
| 200TU4906 | Clio 4           |        60 | O     |
| 203TU4480 | Suzuki Swift-BVA |        80 | O     |
+-----------+------------------+-----------+-------+ </code></pre>
            <pre class="d-none"><code class="nohighlight generate-insert" data-tablename="vehicules">+-----------+------------------+-----------+-------+
  | matricule | vehicule         | prix_unit | libre |
  +-----------+------------------+-----------+-------+
  | 203TU8041 | Clio 4           |        60 | O     |
  | 204TU9333 | Seat IBIZA       |        60 | N     |
  | 205TU6551 | Seat IBIZA       |        60 | O     |
  | 205TU9334 | Clio 5           |        70 | N     |
  | 206TU5473 | Suzuki Swift-BVA |        80 | O     |
  | 206TU9804 | Clio 4           |        60 | O     |
  | 207TU4480 | Suzuki Swift-BVA |        80 | O     |
  | 207TU8780 | Clio 5           |        70 | O     |
  +-----------+------------------+-----------+-------+ </code></pre>
            <div class="d-none d-print-block">
              <pre><code class="sql">INSERT INTO vehicules (matricule, vehicule, prix_unit, libre)
VALUES ('200TU4906', 'Clio 4', 60, 'O');</code></pre>
            </div>
          </li>
          <li>Remplir la table <code>locations</code> par les données suivantes :
            <pre style="font-size: 0.8em;"><code class="nohighlight">+--------------+-----------+----------+---------------+-------------+------------------+
| num_location | matricule | cin      | date_location | date_retour | montant_location |
+--------------+-----------+----------+---------------+-------------+------------------+
|            1 | 203TU4480 | 03972583 | 2022-01-02    | 2022-01-03  |               80 |
|            2 | 206TU5473 | 04202363 | 2022-01-02    | 2022-01-03  |               80 |
+--------------+-----------+----------+---------------+-------------+------------------+</code></pre>
            <p>On remarque qu'au lieu de saisir les informations des clients et des véhicules à chaque fois il nous
              suffit juste d'insérer le <code>cin</code> du client et le <code>matricule</code> du véhicule loué.</p>
            <pre class="d-none"><code class="nohighlight generate-insert" data-tablename="locations">+--------------+-----------+----------+---------------+-------------+------------------+
| num_location | matricule | cin      | date_location | date_retour | montant_location |
+--------------+-----------+----------+---------------+-------------+------------------+
|            3 | 203TU8041 | 04202363 | 2022-01-05    | 2022-01-06  |               60 |
|            4 | 203TU8041 | 03972583 | 2022-01-06    | 2022-01-09  |              180 |
|            5 | 205TU6551 | 04202363 | 2022-01-07    | 2022-01-08  |               60 |
|            6 | 206TU9804 | 04202363 | 2022-01-08    | 2022-01-26  |             1080 |
|            7 | 207TU4480 | 04202363 | 2022-01-10    | 2022-01-12  |              160 |
|            8 | 200TU4906 | 03972583 | 2022-01-13    | 2022-01-14  |               60 |
|            9 | 204TU9333 | 03972583 | 2022-01-15    | 2022-01-16  |               60 |
|           10 | 207TU4480 | 04202363 | 2022-01-18    | 2022-01-19  |               80 |
|           11 | 206TU5473 | 04202363 | 2022-01-21    | 2022-01-22  |               80 |
|           12 | 207TU4480 | 04202363 | 2022-01-24    | 2022-01-25  |               80 |
|           13 | 205TU9334 | 04202363 | 2022-01-28    | 2022-02-03  |              420 |
|           14 | 204TU9333 | 03972583 | 2022-01-28    | 2022-02-01  |              240 |
+--------------+-----------+----------+---------------+-------------+------------------+</code></pre>
          </li>
          <li class="p-break">Ajouter le nouveau client &laquo; Youssef &raquo; son <strong>cin</strong> est &laquo;
            12569800 &raquo; et
            son <b>téléphone</b> est &laquo; 52349157 &raquo;.
          </li>
          <li>Le gérant a voulu insérer l'enregistrement suivant d'une nouvelle cliente
            <code>(client: 'Assia', cin: '12650890', tel: '52349157')</code> en utilisant la commande suivante :
            <pre><code class="sql">INSERT INTO clients (client, cin)
VALUES ('Assia', '12650890');</code></pre>
            <p>Mais il obtient l'erreur suivante :</p>
            <pre><code class="nohighlight">ERROR 1364 (HY000): Field 'tel' doesn't have a default value</code></pre>
            <p><strong>Quel est le problème ? Comment le corriger ?</strong></p>
            <div class="d-none d-print-block">
              <p>Le champ <code>tel</code> est obligatoire le gérant doit l'indiquer pour corriger le problème.</p>
            </div>
          </li>
          <li>Le gérant a corrigé sa commande en tapant :
            <pre><code class="sql">INSERT INTO clients (client, cin, tel)
VALUES ('Assia', '12650890', '52349157');</code></pre>
            <div class="d-print-none">
              <pre><code class="nohighlight">Query OK, 1 row affected (0.010 sec)</code></pre>
            </div>
            <p>Puis, pour vérifier qu'elle a été insérée :</p>
            <pre><code class="sql">SELECT * FROM clients WHERE cin = '12650890';</code></pre>
            <pre><code class="nohighlight">+----------+--------+-------+----------+
| cin      | client | genre | tel      |
+----------+--------+-------+----------+
| 12650890 | Assia  | <mark>M</mark>     | 52349157 |
+----------+--------+-------+----------+
1 row in set (0.001 sec)</code></pre>
            <p><strong>Pourquoi le genre de &laquo; Assia &raquo; est-il incorrect ? Comment le corriger ?</strong></p>
          </li>
          <li>Afficher la liste des clientes de cette agence par ordre croissant de leurs noms.
          </li>
          <li>Afficher la liste des clients qui disposent d'un numéro de téléphone Orange (commençant par 5) ou Tunisie
            Telecom (commençant par 7 ou 9).
          </li>
          <li>Le client &laquo; Aziz &raquo; vient de changer son numéro de téléphone à 25025637. Mettre à jour les
            informations de &laquo; Aziz &raquo;.
          </li>
          <li>Afficher la liste des véhicules 'Clio 5' libres.
          </li>
          <li>Ce véhicule a été loué à &laquo; Youssef &raquo; pendant 5 jours du 01/02/2022 au 06/02/2022.
            <p><strong>Insérer cette location, et mettre à jour la liste des véhicules.</strong> <strong>Vérifier le bon
                déroulement de l'opération.</strong></p>
          </li>
          <li>Oubliant que le véhicule &laquo; Seat IBIZA &raquo; ayant comme matricule &laquo; 204TU9333 &raquo; n'est
            pas libre. Le gérant l'a loué à &laquo; Assia &raquo;. Il a tapé la commande suivante :
            <pre><code class="sql">INSERT INTO locations (matricule, cin, date_location, date_retour, montant_location)
              VALUES ('204TU9333', '12650890', '2022-02-01', '2022-02-03', 2 * 60.0);</code></pre>
            <p>Maintenant, il veut annuler cette location en supprimant cet enregistrement. <strong>Comment vas-t-il
                procéder ?</strong></p>
          </li>
          <!--
          li>(pre>code.sql)+(.d-print-none>pre>code.nohighlight)
          li>(pre>code.sql)+(.d-print-none>pre>code.nohighlight)
          li>(pre>code.sql)+(.d-print-none>pre>code.nohighlight)
          li>(pre>code.sql)+(.d-print-none>pre>code.nohighlight)
-->
        </ol>
      </section>
    </article>
  </main>

  <footer class="d-print-none bg-dark text-white p-2">
    <div class="text-center">Page créée par Mohamed Anis MANI avec ♥</div>
    <div class="text-center small">Année scolaire : 2022/2023</div>
  </footer>

  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/navigation.js"></script>
  <script src="assets/js/pages.js"></script>
  <!--script src="assets/js/highlight.pack.js"></script-->
  <script src="assets/js/highlight.min.js"></script>
  <script src="assets/js/vue.min.js"></script>
  <script src="assets/apps/app01.js"></script>
  <script src="assets/js/sqlquery.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
</body>

</html>